<?xml version="1.0" encoding="UTF-8"?>
<flow>
    <!-- 活动领域 - 创建活动单 -->
    <chain name="INITIAL_TO_PENDING_PAYMENT">
        THEN(
            InitialToPendingPaymentWorkstation,
            CheckExpirePendingPaymentAOWorkstation
        );
    </chain>
    <chain name="WHEN_PENDING_PAYMENT_TO_EFFECTIVE">
        THEN(
            SWITCH(ActivityOrderTypeRouter).TO(
                SIGN_IN_TO_CLAIM,
                PAID_PURCHASE,
                REDEEM_TO_OBTAIN
        )
        );
    </chain>
    <chain name="PENDING_PAYMENT_TO_EFFECTIVE">
        THEN(
            PendingPaymentToEffectiveWorkstation,
            IncreaseAvailableRaffleTimeWorkstation
        );
    </chain>
    <chain name="WHEN_EFFECTIVE_TO_USED">
        THEN(
            UpdateExpiredAOStatusWorkstation,
            CheckEffectiveAOWorkstation
        );
    </chain>
    <chain name="EFFECTIVE_TO_USED">
        THEN(
            UpdateAOUsedRaffleCountAndStatusWorkstation,
            UpdateUserAvailableRaffleCountWorkstation
        ).retry(300, "app.xlog.ggbond.exception.RetryRouterException");
    </chain>
</flow>
